(function(){function $parcel$export(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var $parcel$global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},parcelRequire=$parcel$global.parcelRequire55a5;parcelRequire.register("lCGwp",(function(module,exports){$parcel$export(module.exports,"Sync",(function(){return Sync}));var $hnmIs=parcelRequire("hnmIs"),$9Klpk=parcelRequire("9Klpk"),$3bWnf=parcelRequire("3bWnf"),$9WzNc=parcelRequire("9WzNc"),$div3d=parcelRequire("div3d"),$kb0qF=parcelRequire("kb0qF"),$5ENmm=parcelRequire("5ENmm"),$bWNdT=parcelRequire("bWNdT"),$32Euv=parcelRequire("32Euv"),$auvHb=parcelRequire("auvHb"),joinRoom={nostr:null,mqtt:null,torrent:null},Sync=function(_Base_Sync){"use strict";(0,$kb0qF.default)(Sync,_Base_Sync);var _super=(0,$bWNdT.default)(Sync);function Sync(e,t,n,r,a){var i,c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];return(0,$9Klpk.default)(this,Sync),(i=_super.call(this,t,n,r,a,c,o)).backend=e,i}return(0,$3bWnf.default)(Sync,[{key:"destroy",value:function(){this.connection&&this.connection.leave(),(0,$9WzNc.default)((0,$div3d.default)(Sync.prototype),"destroy",this).call(this)}},{key:"connect",value:function connect(data){var _this=this,_this=this,_superprop_get_connect=function(){return(0,$9WzNc.default)((0,$div3d.default)(Sync.prototype),"connect",_this)};return(0,$hnmIs.default)((function(){return(0,$32Euv.__generator)(this,(function(_state){if(_superprop_get_connect().call(_this,data),joinRoom[_this.backend])return _this.init(!0),[2];switch(_this.backend){case"nostr":parcelRequire("5ZdQa").then((function(e){joinRoom.nostr=e.joinRoom,_this.init(!0)})).catch((function(e){_this.init(!1,e.message)}));break;case"mqtt":parcelRequire("8G6Vu").then((function(e){joinRoom.mqtt=e.joinRoom,_this.init(!0)})).catch((function(e){_this.init(!1,e.message)}));break;case"torrent":eval("import('./trystero-ipfs.min.js')\n.then((e) => {\n  joinRoom.torrent = e.joinRoom\n  this.init(true)\n})\n.catch((e) => {\n  this.init(false, e.message)\n})")}return[2]}))}))()}},{key:"init",value:function(e,t){var n=this.uniqueID();if(e&&n){var r={appId:"liascript"};this.password&&(r.password=this.password);var a=JSON.parse('{"iceServers":[{"urls":"stun:stun.relay.metered.ca:80"},{"urls":"turn:standard.relay.metered.ca:80","username":"5cedc2adff8a8f714555bd79","credential":"azL7pmqh8DkgS50Y"},{"urls":"turn:standard.relay.metered.ca:80?transport=tcp","username":"5cedc2adff8a8f714555bd79","credential":"azL7pmqh8DkgS50Y"},{"urls":"turn:standard.relay.metered.ca:443","username":"5cedc2adff8a8f714555bd79","credential":"azL7pmqh8DkgS50Y"},{"urls":"turns:standard.relay.metered.ca:443?transport=tcp","username":"5cedc2adff8a8f714555bd79","credential":"azL7pmqh8DkgS50Y"}]}');a&&(r.rtcConfig=a),this.connection=joinRoom[this.backend](r,n),this.connection.onPeerJoin((function(e){return console.log("".concat(e," joined"))})),this.connection.onPeerLeave((function(e){return console.log("".concat(e," left"))}));var i=(0,$5ENmm.default)(this.connection.makeAction("message"),2),c=i[0],o=i[1];this.pub=c,this.sub=o;var u=this;this.sub((function(e,t){if(e)try{var n=(0,$5ENmm.default)(e,3),r=n[0],a=n[1],i=n[2];if(r){if(null===a)return;i==u.db.timestamp?u.applyUpdate($auvHb.base64_to_unit8(a)):i>u.db.timestamp?u.broadcast(!0,u.db.encode()):(u.db.timestamp=i,u.applyUpdate($auvHb.base64_to_unit8(a),!0))}else u.pubsubReceive($auvHb.base64_to_unit8(a))}catch(e){console.warn(u.backend,e.message)}})),this.sendConnect()}else{var s=this.backend+" unknown error";t&&(s="Could not load resource: "+t),this.sendDisconnectError(s)}}},{key:"broadcast",value:function(e,t){if(this.publish){var n=null==t?null:$auvHb.uint8_to_base64(t);this.pub([e,n,this.db.timestamp])}}}]),Sync}($auvHb.Sync)})),parcelRequire.register("5ZdQa",(function(e,t){e.exports=parcelRequire("3OMJO")(parcelRequire("5B9gS").getBundleURL("bFNS0")+parcelRequire("b9xd4").resolve("6gAOH")).then((function(){return parcelRequire("1UDrq")}))})),parcelRequire.register("8G6Vu",(function(e,t){e.exports=parcelRequire("3OMJO")(parcelRequire("5B9gS").getBundleURL("bFNS0")+parcelRequire("b9xd4").resolve("7U1md")).then((function(){return parcelRequire("aB40U")}))}))})();