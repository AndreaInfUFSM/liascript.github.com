!function(e,t,r,n,s){var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},i="function"==typeof o[n]&&o[n],c=i.cache||{},u="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function l(t,r){if(!c[t]){if(!e[t]){var s="function"==typeof o[n]&&o[n];if(!r&&s)return s(t,!0);if(i)return i(t,!0);if(u&&"string"==typeof t)return u(t);var a=Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}h.resolve=function(r){var n=e[t][1][r];return null!=n?n:r},h.cache={};var p=c[t]=new l.Module(t);e[t][0].call(p.exports,h,p,p.exports,this)}return c[t].exports;function h(e){var t=h.resolve(e);return!1===t?{}:l(t)}}l.isParcelRequire=!0,l.Module=function(e){this.id=e,this.bundle=l,this.exports={}},l.modules=e,l.cache=c,l.parent=i,l.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(l,"root",{get:function(){return o[n]}}),o[n]=l;for(var a=0;a<t.length;a++)l(t[a])}({ff1ML:[function(e,t,r){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"Sync",(function(){return _}));var s=e("@swc/helpers/_/_async_to_generator"),o=e("@swc/helpers/_/_class_call_check"),i=e("@swc/helpers/_/_create_class"),c=e("@swc/helpers/_/_get"),u=e("@swc/helpers/_/_get_prototype_of"),l=e("@swc/helpers/_/_inherits"),a=e("@swc/helpers/_/_sliced_to_array"),p=e("@swc/helpers/_/_create_super"),h=e("@swc/helpers/_/_ts_generator"),d=e("../Base/index"),f=e("../Crypto");Object.defineProperty(Array.prototype,"flat",{value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.reduce((function(t,r){return t.concat(Array.isArray(r)&&e>1?r.flat(e-1):r)}),[])}});var _=function(e){(0,l._)(r,e);var t=(0,p._)(r);function r(){var e;return(0,o._)(this,r),(e=t.apply(this,arguments)).store="",e.gunServer=[],e.persistent=!1,e}return(0,i._)(r,[{key:"destroy",value:function(){this.gunServer=[],delete this.gun,(0,c._)((0,u._)(r.prototype),"destroy",this).call(this)}},{key:"uniqueID",value:function(){var e=(0,c._)((0,u._)(r.prototype),"uniqueID",this).call(this);return e?btoa(e+(this.persistent?"p":"")):null}},{key:"connect",value:function(e){var t=this,n=this;return(0,s._)((function(){var s,o;return(0,h._)(this,(function(i){return(0,c._)((0,u._)(r.prototype),"connect",t).call(n,e),n.gunServer=(null===(s=e.config)||void 0===s?void 0:s.urls)||[],n.persistent=(null===(o=e.config)||void 0===o?void 0:o.persistent)||!1,window.Gun?n.init(!0):n.load(["https://cdn.jsdelivr.net/npm/gun/gun.js",f.Crypto.url],n),[2]}))}))()}},{key:"init",value:function(e,t){if(0==this.gunServer.length)return this.sendDisconnectError("You have to provide at least one relay server.");var r=this.uniqueID();if(e&&window.Gun&&r){this.gun=window.Gun({peers:this.gunServer}),this.store=r,f.Crypto.init(this.password);var n=this;this.persistent&&this.gun.get(this.store).once((function(e){if(e&&e.msg)try{var t=(0,a._)(f.Crypto.decode(e.msg),2),r=(t[0],t[1]);setTimeout((function(){var e;null===(e=n.gun)||void 0===e||e.get(n.store).put({msg:f.Crypto.encode(["",r])})}),1e3)}catch(e){console.warn("GunDB:",e.message)}})),this.gun.get(this.store).on((function(e,t){try{var r=(0,a._)(f.Crypto.decode(e.msg),2),s=r[0],o=r[1];s!=n.token&&null!=o&&n.applyUpdate(d.base64_to_unit8(o))}catch(e){console.warn("GunDB",e.message)}})),this.persistent||this.broadcast(null),this.sendConnect()}else{var s="GunDB unknown error";t?s="Could not load resource: "+t:window.Gun||(s="Could not load GunDB interface"),this.sendDisconnectError(s)}}},{key:"broadcast",value:function(e){if(this.gun){var t=null==e?null:d.uint8_to_base64(e);this.gun.get(this.store).put({msg:f.Crypto.encode([this.token,t])})}}}]),r}(d.Sync)},{"@swc/helpers/_/_async_to_generator":"9nZrO","@swc/helpers/_/_class_call_check":"aKk2j","@swc/helpers/_/_create_class":"1kStN","@swc/helpers/_/_get":"eIgRj","@swc/helpers/_/_get_prototype_of":"cFXpH","@swc/helpers/_/_inherits":"cPJNz","@swc/helpers/_/_sliced_to_array":"gC503","@swc/helpers/_/_create_super":"4oibw","@swc/helpers/_/_ts_generator":"9rWj2","../Base/index":"5ZLLr","../Crypto":"kdUHg","@parcel/transformer-js/src/esmodule-helpers.js":"1NFta"}],kdUHg:[function(e,t,r){var n=e("@parcel/transformer-js/src/esmodule-helpers.js");n.defineInteropFlag(r),n.export(r,"Crypto",(function(){return s}));var s={url:"https://cdn.jsdelivr.net/npm/simple-crypto-js@2.5.0/dist/SimpleCrypto.min.js",crypt:null,check:function(){return!!window.SimpleCrypto},init:function(e){try{"string"==typeof e&&e.length>0?this.crypt=new SimpleCrypto(e):this.crypt=null}catch(e){console.warn("Crypto: ",e),this.crypt=null}},encode:function(e){return this.crypt?this.crypt.encrypt(btoa(encodeURIComponent(JSON.stringify(e)))):JSON.stringify(e)},decode:function(e){return this.crypt?JSON.parse(decodeURIComponent(atob(this.crypt.decrypt(e)))):JSON.parse(e)}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"1NFta"}]},[],0,"parcelRequire55a5");
