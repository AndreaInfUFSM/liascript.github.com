!function(e,t,s,r,n){var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},o="function"==typeof i[r]&&i[r],u=o.cache||{},c="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function a(t,s){if(!u[t]){if(!e[t]){var n="function"==typeof i[r]&&i[r];if(!s&&n)return n(t,!0);if(o)return o(t,!0);if(c&&"string"==typeof t)return c(t);var l=Error("Cannot find module '"+t+"'");throw l.code="MODULE_NOT_FOUND",l}h.resolve=function(s){var r=e[t][1][s];return null!=r?r:s},h.cache={};var p=u[t]=new a.Module(t);e[t][0].call(p.exports,h,p,p.exports,this)}return u[t].exports;function h(e){var t=h.resolve(e);return!1===t?{}:a(t)}}a.isParcelRequire=!0,a.Module=function(e){this.id=e,this.bundle=a,this.exports={}},a.modules=e,a.cache=u,a.parent=o,a.register=function(t,s){e[t]=[function(e,t){t.exports=s},{}]},Object.defineProperty(a,"root",{get:function(){return i[r]}}),i[r]=a;for(var l=0;l<t.length;l++)a(t[l])}({gSAUu:[function(e,t,s){var r=e("@parcel/transformer-js/src/esmodule-helpers.js");r.defineInteropFlag(s),r.export(s,"Sync",(function(){return b}));var n=e("@swc/helpers/_/_async_to_generator"),i=e("@swc/helpers/_/_class_call_check"),o=e("@swc/helpers/_/_create_class"),u=e("@swc/helpers/_/_get"),c=e("@swc/helpers/_/_get_prototype_of"),a=e("@swc/helpers/_/_inherits"),l=e("@swc/helpers/_/_create_super"),p=e("@swc/helpers/_/_ts_generator"),h=e("../Base/index"),_=e("../../liascript/log"),f=r.interopDefault(_),b=function(e){(0,a._)(s,e);var t=(0,l._)(s);function s(){var e;return(0,i._)(this,s),(e=t.apply(this,arguments)).channel="",e}return(0,o._)(s,[{key:"destroy",value:function(){this.pubnub&&(this.pubnub.unsubscribeAll(),this.pubnub.stop()),(0,u._)((0,c._)(s.prototype),"destroy",this).call(this)}},{key:"connect",value:function(e){var t=this,r=this;return(0,n._)((function(){return(0,p._)(this,(function(n){return(0,u._)((0,c._)(s.prototype),"connect",t).call(r,e),r.publishKey=e.config.publishKey,r.subscribeKey=e.config.subscribeKey,window.PubNub?r.init(!0):r.load(["//cdn.pubnub.com/sdk/javascript/pubnub.4.33.1.min.js"],r),[2]}))}))()}},{key:"init",value:function(e,t){if(!this.publishKey||!this.subscribeKey)return this.sendDisconnectError("You have to provide a valid pair of keys");var s=this.uniqueID();if(e&&window.PubNub&&s){this.channel=btoa(s),this.pubnub=new PubNub({publishKey:this.publishKey,subscribeKey:this.subscribeKey,uuid:this.token,heartbeatInterval:30,cipherKey:this.password}),this.pubnub.subscribe({channels:[this.channel],withPresence:!0,restore:!1});var r=this;this.pubnub.addListener({status:function(e){f.default.info("PUBNUB status:",e),"PNConnectedCategory"===e.category?r.sendConnect():"PNBadRequestCategory"===e.category&&r.sendDisconnectError(e.errorData.message)},message:function(e){e.publisher!==r.token&&r.applyUpdate(h.base64_to_unit8(e.message))},presence:function(e){"leave"===e.action&&r.db.removePeer(e.uuid)}})}}},{key:"broadcast",value:function(e){this.pubnub&&this.pubnub.publish({channel:this.channel,message:h.uint8_to_base64(e),storeInHistory:!1},(function(e,t){}))}}]),s}(h.Sync)},{"@swc/helpers/_/_async_to_generator":"9nZrO","@swc/helpers/_/_class_call_check":"aKk2j","@swc/helpers/_/_create_class":"1kStN","@swc/helpers/_/_get":"eIgRj","@swc/helpers/_/_get_prototype_of":"cFXpH","@swc/helpers/_/_inherits":"cPJNz","@swc/helpers/_/_create_super":"4oibw","@swc/helpers/_/_ts_generator":"9rWj2","../Base/index":"5ZLLr","../../liascript/log":"2fmSk","@parcel/transformer-js/src/esmodule-helpers.js":"1NFta"}]},[],0,"parcelRequire55a5");
